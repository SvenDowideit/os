#!/bin/bash
set -e

cd $(dirname $0)/..

IMAGES=$(bin/host_ros c images -i build/initrd/usr/share/ros/os-config.yml)
for i in $IMAGES; do
    if [ "${FORCE_PULL}" = "1" ] || ! docker inspect $i >/dev/null 2>&1; then
        docker pull $i
    fi
done

# add the images that we normally pull from hub
if [ -e "assets/os-images.list" ]; then
  DEVIMAGES=$(cat assets/os-images.list | tr "\n" " ")
fi

docker save ${IMAGES} ${DEVIMAGES} > build/images.tar
